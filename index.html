<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Calculadora de Vigilantes Mensual</title>
<style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        h1, h2, h3 {
            color: var(--light-color);
            text-align: center;
        }
        
        h1 {
            margin-bottom: 30px;
            font-size: 24px;
        }
        
        h2 {
            color: var(--dark-color);
            font-size: 20px;
            margin-top: 0;
        }
        
        h3 {
            color: var(--dark-color);
            font-size: 18px;
            margin: 15px 0 10px;
            text-align: left;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 16px;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            transition: background-color 0.3s;
            margin-top: 5px;
        }
        
        button:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-danger {
            background-color: var(--accent-color);
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }
        
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--primary-color);
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .total-row {
            font-weight: bold;
            background-color: #e3f2fd !important;
        }
        
        .day-card {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary-color);
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .day-date {
            font-weight: bold;
        }
        
        .results-section {
            display: none;
        }
        
        .visible {
            display: block;
        }
        
        .info-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            margin-right: 10px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--success-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .toggle-label {
            font-size: 14px;
            color: var(--dark-color);
        }
        
        @media (min-width: 768px) {
            .container {
                max-width: 800px;
                margin: 0 auto;
            }
            
            .form-row {
                display: flex;
                gap: 15px;
            }
            
            .form-row .form-group {
                flex: 1;
            }
            
            .half-row {
                display: flex;
                gap: 15px;
            }
            
            .half-row .form-group {
                flex: 1;
            }
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
        
        .disabled-input {
            opacity: 0.6;
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
<div class="container">
<h1>Calculadora de Vigilantes Mensual</h1>
<div class="card">
<h2>Datos B√°sicos</h2>
<div class="form-group">
  <label for="vigilante-name">Nombre del Vigilante</label>
  <input type="text" id="vigilante-name" name="vigilante-name" placeholder="Escriba el nombre completo">
</div>
<div class="form-group">
<label for="basic-salary">Salario B√°sico Mensual</label>
<input id="basic-salary" placeholder="Ingrese el salario b√°sico" type="number"/>
</div>
<div class="form-group">
<label for="bonus">Valor de Rodamiento</label>
<input id="bonus" placeholder="Ingrese valor de rodamiento por jornada" type="number"/>
</div>
<div class="toggle-container">
<label class="toggle-switch">
<input checked="" id="include-rest-days" type="checkbox"/>
<span class="slider"></span>
</label>
<span class="toggle-label">Incluir d√≠as de descanso</span>
</div>
<div class="toggle-container">
<label class="toggle-switch">
<input checked="" id="include-benefits-deductions" type="checkbox"/>
<span class="slider"></span>
</label>
<span class="toggle-label">Incluir prestaciones y deducciones</span>
</div>
</div>
<div class="card">
<h2>Agregar Jornada Laboral</h2>
<div class="form-group">
<label for="work-date">Fecha de Entrada</label>
<input id="work-date" type="date"/>
</div>
<div class="half-row">
<div class="form-group">
<label for="start-time">Hora de Entrada</label>
<input id="start-time" type="time" value="06:00"/>
</div>
<div class="form-group">
<label for="end-time">Hora de Salida</label>
<input id="end-time" type="time" value="18:00"/>
</div>
</div>
<div class="form-group">
<label for="end-date">Fecha de Salida (turnos 24+ horas)</label>
<input id="end-date" type="date"/>
</div>
<button class="btn-success" id="add-day">Agregar Jornada</button>
</div>
<div class="card" id="days-list-container">
<h2>Jornadas Registradas</h2>
<div id="days-list">
<p id="no-days-message">No hay jornadas registradas a√∫n.</p>
</div>
</div>
<div class="card results-section" id="results-section">
<h2>Resultados del C√°lculo</h2>
<div id="hours-results">
<h3>Horas Trabajadas</h3>
<table id="hours-table">
<thead>
<tr>
<th>Tipo de Hora</th>
<th>Horas</th>
<th>Valor/Hora</th>
<th>Total</th>
</tr>
</thead>
<tbody id="hours-body"></tbody>
</table>
</div>
<div id="rest-days-results">
<h3>D√≠as de Descanso</h3>
<table id="rest-days-table">
<thead>
<tr>
<th>Concepto</th>
<th>D√≠as</th>
<th>Valor/D√≠a</th>
<th>Total</th>
</tr>
</thead>
<tbody id="rest-days-body"></tbody>
</table>
</div>
<div id="subsidy-results"><h3>Subsidio de Transporte 200.000</h3><table id="subsidy-table"><thead><tr><th>Concepto</th><th>C√°lculo</th><th>Total</th></tr></thead><tbody id="subsidy-body"></tbody></table></div><div id="benefits-results">
<h3>Prestaciones Sociales</h3>
<table id="benefits-table">
<thead>
<tr>
<th>Concepto</th>
<th>C√°lculo</th>
<th>Total</th>
</tr>
</thead>
<tbody id="benefits-body"></tbody>
</table>
</div>
<div id="payment-results">
<h3>Liquidaci√≥n</h3>
<table id="payment-table">
<thead>
<tr>
<th>Concepto</th>
<th>Valor</th>
</tr>
</thead>
<tbody id="payment-body"></tbody>
</table>
</div>
<div id="deductions-results">
<h3>Deducciones Legales</h3>
<table id="deductions-table">
<thead>
<tr>
<th>Concepto</th>
<th>Porcentaje</th>
<th>Valor</th>
</tr>
</thead>
<tbody id="deductions-body"></tbody>
</table>
</div>
<div id="totals-results">
<h3>Resumen Final</h3>
<table id="totals-table">
<thead>
<tr>
<th>Concepto</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td>Total Devengado</td>
<td id="total-earned">$0</td>
</tr>
<tr>
<td>Total Deducciones</td>
<td id="total-deductions">$0</td>
</tr>
<tr class="total-row">
<td>NETO A PAGAR</td>
<td id="net-payment">$0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="form-group">
<button class="btn-success" id="calculate-btn">Calcular Liquidaci√≥n</button>
<button class="btn-warning" id="reset-btn">Reiniciar Calculadora</button>
<button class="btn-danger" id="print-btn" style="display:none;">Imprimir en PDF</button>
</div>

<!-- Tutorial animado -->
<div style="
    background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
    padding: 15px;
    border-radius: 8px;
    margin: 25px auto;
    overflow: hidden;
    max-width: 100%;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
">
    <div style="
        display: inline-block;
        padding-left: 100%;
        animation: scrollTutorial 20s linear infinite;
        font-weight: bold;
        font-size: 20px;
        color: white;
        white-space: nowrap;
    ">
        üö¶ TUTORIAL REL√ÅMPAGO || 1Ô∏è‚É£ Ingresa tu NOMBRE (obligatorio) || 2Ô∏è‚É£ Agrega SALARIO B√ÅSICO || 3Ô∏è‚É£ Valor de RODAMIENTO (si aplica) || 4Ô∏è‚É£ Registra JORNADAS || 5Ô∏è‚É£ ¬°CALCULA! üí∞
    </div>
</div>

</div>
<script>
        document.addEventListener('DOMContentLoaded', function() {
            // Base de datos de d√≠as festivos
            const holidays = {
                '2025': [
                    '2025-01-01', // A√±o Nuevo
                    '2025-01-05', // Domingo
                    '2025-01-06', // Reyes Magos
                    '2025-01-12', // Domingo
                    '2025-01-19', // Domingo
                    '2025-01-26', // Domingo
                    '2025-02-02', // Domingo
                    '2025-02-09', // Domingo
                    '2025-02-16', // Domingo
                    '2025-02-23', // Domingo
                    '2025-03-02', // Domingo
                    '2025-03-09', // Domingo
                    '2025-03-16', // Domingo
                    '2025-03-23', // Domingo
                    '2025-03-24', // D√≠a de San Jos√©
                    '2025-03-30', // Domingo
                    '2025-04-06', // Domingo
                    '2025-04-13', // Domingo
                    '2025-04-17', // Jueves Santo
                    '2025-04-18', // Viernes Santo
                    '2025-04-20', // Domingo
                    '2025-04-27', // Domingo
                    '2025-05-01', // D√≠a del Trabajo
                    '2025-05-04', // Domingo
                    '2025-05-11', // Domingo
                    '2025-05-18', // Domingo
                    '2025-05-25', // Domingo
                    '2025-06-01', // Domingo
                    '2025-06-02', // Ascensi√≥n de Jes√∫s
                    '2025-06-08', // Domingo
                    '2025-06-15', // Domingo
                    '2025-06-22', // Domingo
                    '2025-06-23', // Corpus Christi
                    '2025-06-29', // Domingo
                    '2025-06-30', // Sagrado Coraz√≥n de Jes√∫s / San Pedro y San Pablo
                    '2025-07-06', // Domingo
                    '2025-07-13', // Domingo
                    '2025-07-20', // D√≠a de la Independencia
                    '2025-07-27', // Domingo
                    '2025-08-03', // Domingo
                    '2025-08-07', // Batalla de Boyac√°
                    '2025-08-10', // Domingo
                    '2025-08-17', // Domingo
                    '2025-08-18', // Asunci√≥n de la Virgen
                    '2025-08-24', // Domingo
                    '2025-08-31', // Domingo
                    '2025-09-07', // Domingo
                    '2025-09-14', // Domingo
                    '2025-09-21', // Domingo
                    '2025-09-28', // Domingo
                    '2025-10-05', // Domingo
                    '2025-10-12', // Domingo / D√≠a de la Raza
                    '2025-10-13', // D√≠a de la Raza (traslado)
                    '2025-10-19', // Domingo
                    '2025-10-26', // Domingo
                    '2025-11-02', // Domingo / Todos los Santos
                    '2025-11-03', // Todos los Santos (traslado)
                    '2025-11-09', // Domingo
                    '2025-11-16', // Domingo
                    '2025-11-17', // Independencia de Cartagena
                    '2025-11-23', // Domingo
                    '2025-11-30', // Domingo
                    '2025-12-07', // Domingo
                    '2025-12-08', // Inmaculada Concepci√≥n
                    '2025-12-14', // Domingo
                    '2025-12-21', // Domingo
                    '2025-12-25', // Navidad
                    '2025-12-28'  // Domingo
                ],
                '2026': [
                    '2026-01-01', // A√±o Nuevo
                    '2026-01-06', // Reyes Magos
                    '2026-03-22', // D√≠a de San Jos√©
                    '2026-04-02', // Jueves Santo
                    '2026-04-03', // Viernes Santo
                    '2026-05-01', // D√≠a del Trabajo
                    '2026-05-18', // Ascensi√≥n de Jes√∫s
                    '2026-06-08', // Corpus Christi
                    '2026-06-15', // Sagrado Coraz√≥n de Jes√∫s
                    '2026-06-29', // San Pedro y San Pablo
                    '2026-07-20', // D√≠a de la Independencia
                    '2026-08-07', // Batalla de Boyac√°
                    '2026-08-17', // Asunci√≥n de la Virgen
                    '2026-10-12', // D√≠a de la Raza
                    '2026-11-02', // Todos los Santos
                    '2026-11-16', // Independencia de Cartagena
                    '2026-12-08', // Inmaculada Concepci√≥n
                    '2026-12-25'  // Navidad
                ],
                '2027': [
                    '2027-01-01', // A√±o Nuevo
                    '2027-01-06', // Reyes Magos
                    '2027-03-21', // D√≠a de San Jos√©
                    '2027-04-14', // Jueves Santo
                    '2027-04-15', // Viernes Santo
                    '2027-05-01', // D√≠a del Trabajo
                    '2027-05-10', // Ascensi√≥n de Jes√∫s
                    '2027-05-31', // Corpus Christi
                    '2027-06-07', // Sagrado Coraz√≥n de Jes√∫s
                    '2027-06-29', // San Pedro y San Pablo
                    '2027-07-20', // D√≠a de la Independencia
                    '2027-08-07', // Batalla de Boyac√°
                    '2027-08-16', // Asunci√≥n de la Virgen
                    '2027-10-18', // D√≠a de la Raza
                    '2027-11-01', // Todos los Santos
                    '2027-11-15', // Independencia de Cartagena
                    '2027-12-08', // Inmaculada Concepci√≥n
                    '2027-12-25'  // Navidad
                ],
            };

            // Configuraci√≥n inicial
            const addDayBtn = document.getElementById('add-day');
            const calculateBtn = document.getElementById('calculate-btn');
            const resetBtn = document.getElementById('reset-btn');
            const daysList = document.getElementById('days-list');
            const noDaysMessage = document.getElementById('no-days-message');
            const resultsSection = document.getElementById('results-section');
            const includeRestDays = document.getElementById('include-rest-days');
            const workDateInput = document.getElementById('work-date');
            const endDateInput = document.getElementById('end-date');
            const printBtn = document.getElementById('print-btn');
            const basicSalaryInput = document.getElementById('basic-salary');
            const vigilanteNameInput = document.getElementById('vigilante-name');
            
            let workDays = [];
            let nextId = 1;
            
            // Funciones auxiliares
            function isSunday(dateString) {
                // dateString is 'YYYY-MM-DD'
                // Important: JavaScript's Date constructor interprets 'YYYY-MM-DD' as UTC.
                // To correctly determine the day in Colombia (UTC-5), we need to account for this.
                // If '2023-10-01' is a Sunday in UTC, it might be Saturday evening in Colombia.
                // A reliable way is to construct the date with a time component and timezone offset.
                const date = new Date(dateString + 'T12:00:00-05:00'); // Noon in Colombia
                return date.getDay() === 0; // getDay() is locale-dependent; 0 for Sunday
            }
            
            function isHoliday(date) { // date is a Date object, assumed to be in local (server) timezone
                                       // but representing a conceptual date in Colombia.
                // To reliably check against a 'YYYY-MM-DD' holiday list, format the Date object
                // as 'YYYY-MM-DD' *as it would be in Colombia*.
                const year = date.getFullYear(); // This will be correct if date was created with -05:00
                const month = (date.getMonth() + 1).toString().padStart(2, '0'); // getMonth is 0-indexed
                const day = date.getDate().toString().padStart(2, '0'); // getDate is 1-indexed
                const dateStrInColombia = `${year}-${month}-${day}`;

                return holidays[year] && holidays[year].includes(dateStrInColombia);
            }

            // Helper function to get day type (normal, sunday, festive)
            function determineDayType(dateStringForSundayCheck, dateObjectForHolidayCheck) {
                // dateStringForSundayCheck is 'YYYY-MM-DD' for isSunday
                // dateObjectForHolidayCheck is a Date object representing the calendar date in Colombia for isHoliday
                if (isSunday(dateStringForSundayCheck)) {
                    return 'sunday';
                } else if (isHoliday(dateObjectForHolidayCheck)) {
                    return 'festive';
                }
                return 'normal';
            }

            // Helper function to calculate hours for a specific time segment within a single day
            function calculateHoursForDaySegment(segmentStart, segmentEnd, dayType, accumulatedOrdinaryHoursToday) {
                // segmentStart and segmentEnd are Date objects (in Colombian TZ context)
                // dayType is 'normal', 'sunday', or 'festive'
                // accumulatedOrdinaryHoursToday is the count of ordinary hours already worked *on that specific calendar day*

                let ordinaryDay = 0, ordinaryNight = 0;
                let extraDay = 0, extraNight = 0;
                let sundayBase = 0, sundayExtra = 0;
                let festiveBase = 0, festiveExtra = 0;

                const DAY_START_HOUR = 6; // 6:00 am
                const NIGHT_START_HOUR = 21; // 9:00 pm
                const ORDINARY_LIMIT_HOURS = 8;

                let current = new Date(segmentStart);

                while (current < segmentEnd) {
                    const iterationEnd = new Date(current.getTime() + 15 * 60000); // 15-min segments
                    const realEnd = iterationEnd > segmentEnd ? segmentEnd : iterationEnd;
                    const duration = (realEnd - current) / (1000 * 60 * 60);

                    if (duration <= 0) {
                        current = realEnd;
                        continue;
                    }

                    const currentHour = current.getHours(); // Hour in Colombian timezone
                    const isNightTime = currentHour >= NIGHT_START_HOUR || currentHour < DAY_START_HOUR;

                    if (dayType === 'sunday') {
                        // On Sundays, first 8 hours are "sunday base", rest are "sunday extra"
                        // No distinction between day/night for these categories in the provided return structure.
                        // The rate for sunday/extraSunday implicitly covers day/night.
                        if (sundayBase < ORDINARY_LIMIT_HOURS) {
                            const remainingBase = ORDINARY_LIMIT_HOURS - sundayBase;
                            if (duration <= remainingBase) {
                                sundayBase += duration;
                            } else {
                                sundayBase += remainingBase;
                                sundayExtra += (duration - remainingBase);
                            }
                        } else {
                            sundayExtra += duration;
                        }
                    } else if (dayType === 'festive') {
                        // Similar logic for festive days
                        if (festiveBase < ORDINARY_LIMIT_HOURS) {
                            const remainingBase = ORDINARY_LIMIT_HOURS - festiveBase;
                            if (duration <= remainingBase) {
                                festiveBase += duration;
                            } else {
                                festiveBase += remainingBase;
                                festiveExtra += (duration - remainingBase);
                            }
                        } else {
                            festiveExtra += duration;
                        }
                    } else { // normal day
                        const totalOrdinaryForThisDaySegment = ordinaryDay + ordinaryNight;
                        // Check against (ORDINARY_LIMIT_HOURS - accumulatedOrdinaryHoursToday)
                        // to see if ordinary limit *for the day* has been reached.
                        if (accumulatedOrdinaryHoursToday + totalOrdinaryForThisDaySegment < ORDINARY_LIMIT_HOURS) {
                            const remainingOrdinaryForDay = ORDINARY_LIMIT_HOURS - (accumulatedOrdinaryHoursToday + totalOrdinaryForThisDaySegment);
                            if (duration <= remainingOrdinaryForDay) { // Segment fits entirely within remaining ordinary time for the day
                                if (isNightTime) ordinaryNight += duration;
                                else ordinaryDay += duration;
                            } else { // Segment crosses from ordinary to extra
                                if (isNightTime) {
                                    ordinaryNight += remainingOrdinaryForDay;
                                    extraNight += (duration - remainingOrdinaryForDay);
                                } else {
                                    ordinaryDay += remainingOrdinaryForDay;
                                    // If it crosses into night time as well, this needs more granular split.
                                    // For simplicity, assume 15-min block stays day or night.
                                    // This is a limitation if a 15-min block itself crosses day/night AND ord/extra.
                                    // Given 15-min granularity, this edge case is minor.
                                    extraDay += (duration - remainingOrdinaryForDay);
                                }
                            }
                        } else { // Already in extra time for the day
                            if (isNightTime) extraNight += duration;
                            else extraDay += duration;
                        }
                    }
                    current = realEnd;
                }

                return {
                    normal: ordinaryDay, night: ordinaryNight,
                    extraDay: extraDay, extraNight: extraNight,
                    sunday: sundayBase, extraSunday: sundayExtra,
                    festive: festiveBase, extraFestive: festiveExtra,
                    // Return the ordinary hours processed in *this segment* for normal days
                    processedOrdinaryInSegment: ordinaryDay + ordinaryNight
                };
            }
            
            function formatDate(dateString) {
                const date = new Date(dateString);
                // A√±ade 5 horas para compensar la zona horaria de Colombia (UTC-5)
                date.setHours(date.getHours() + 5);
                const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
                return date.toLocaleDateString('es-ES', options);
            }
            
            function calculateWorkHours(startDateStr, startTimeStr, endDateStr, endTimeStr, startDayType) {
                // startDateStr, endDateStr are 'YYYY-MM-DD'
                // startTimeStr, endTimeStr are 'HH:MM'
                // startDayType is the type of the startDateStr (passed from caller)

                const results = {
                    normal: 0, night: 0, extraDay: 0, extraNight: 0,
                    festive: 0, extraFestive: 0, sunday: 0, extraSunday: 0
                };

                const addHours = (segmentHours) => {
                    results.normal += segmentHours.normal;
                    results.night += segmentHours.night;
                    results.extraDay += segmentHours.extraDay;
                    results.extraNight += segmentHours.extraNight;
                    results.festive += segmentHours.festive;
                    results.extraFestive += segmentHours.extraFestive;
                    results.sunday += segmentHours.sunday;
                    results.extraSunday += segmentHours.extraSunday;
                };

                // Helper to create Date objects in Colombian context
                const createColombianDate = (dateStr, timeStr) => new Date(`${dateStr}T${timeStr}-05:00`);

                let currentSegmentStart = createColombianDate(startDateStr, startTimeStr);
                const overallEnd = createColombianDate(endDateStr, endTimeStr);

                if (currentSegmentStart >= overallEnd) return results; // No duration or invalid

                let accumulatedOrdinaryForDay = 0; // Tracks ordinary hours for the current calendar day (for normal days)

                while (currentSegmentStart < overallEnd) {
                    // Determine the calendar date string (YYYY-MM-DD) for the current segment in Colombian time
                    // This is tricky with Date objects. Forcing UTC interpretation then adding offset for display/logic
                    // is one way, but direct construction with offset is better.
                    // Since currentSegmentStart is already a Date object representing Colombian time:
                    const tempYear = currentSegmentStart.getFullYear();
                    const tempMonth = (currentSegmentStart.getMonth() + 1).toString().padStart(2, '0');
                    const tempDay = currentSegmentStart.getDate().toString().padStart(2, '0');
                    const currentSegmentDateStr = `${tempYear}-${tempMonth}-${tempDay}`;

                    // Determine end of this processing segment: either overallEnd or midnight of currentSegmentStart's day
                    let endOfCurrentDay = new Date(currentSegmentStart);
                    endOfCurrentDay.setHours(24, 0, 0, 0); // Midnight, effectively start of next day

                    const segmentActualEnd = new Date(Math.min(overallEnd.getTime(), endOfCurrentDay.getTime()));

                    // Determine day type for the currentSegmentDateStr
                    let actualDayType;
                    // The Date object for isHoliday needs to represent the calendar date correctly.
                    // currentSegmentStart is fine as it's already in the correct "local" (Colombian) time.
                    if (currentSegmentDateStr === startDateStr) { // First day of the shift
                        actualDayType = startDayType;
                    } else { // Subsequent day
                        actualDayType = determineDayType(currentSegmentDateStr, currentSegmentStart);
                    }
                    
                    const segmentHoursResult = calculateHoursForDaySegment(
                        currentSegmentStart,
                        segmentActualEnd,
                        actualDayType,
                        accumulatedOrdinaryForDay
                    );
                    addHours(segmentHoursResult);

                    // Update for next iteration
                    if (actualDayType === 'normal') {
                        accumulatedOrdinaryForDay += segmentHoursResult.processedOrdinaryInSegment;
                    }

                    // If segmentActualEnd is at midnight (i.e., we are transitioning to a new day)
                    if (segmentActualEnd.getTime() === endOfCurrentDay.getTime()) {
                        accumulatedOrdinaryForDay = 0; // Reset for the new calendar day
                    }
                    // If segmentActualEnd is overallEnd and it's before midnight, accumulatedOrdinaryForDay carries over
                    // but the loop will terminate.
                    
                    currentSegmentStart = new Date(segmentActualEnd);
                }

                return results;
            }
            
            function getDayTypeName(type) {
                const types = {
                    'normal': 'D√≠a Normal',
                    'festive': 'Festivo',
                    'sunday': 'Domingo'
                };
                return types[type] || type;
            }
            
            function calculateTotalHours(startDate, startTime, endDate, endTime) {
                const start = new Date(`${startDate}T${startTime}`);
                const end = new Date(`${endDate}T${endTime}`);
                const diffMs = end - start;
                const diffHours = diffMs / (1000 * 60 * 60);
                const hours = Math.floor(diffHours);
                const minutes = Math.floor((diffHours - hours) * 60);
                return `${hours} horas y ${minutes} minutos`;
            }
            
            function formatCurrency(value) {
                return '$' + value.toFixed(0).replace(/\d(?=(\d{3})+$)/g, '$&.');
            }
            
            function renderDaysList() {
                if (workDays.length === 0) {
                    noDaysMessage.style.display = 'block';
                    daysList.innerHTML = '';
                    return;
                }
                
                noDaysMessage.style.display = 'none';
                daysList.innerHTML = '';
                
                workDays.forEach(day => {
                    const dayCard = document.createElement('div');
                    dayCard.className = 'day-card';
                    
                    const isMultiDay = day.date !== day.endDate;
                    const dateText = isMultiDay 
                        ? `${formatDate(day.date)} a ${formatDate(day.endDate)}` 
                        : formatDate(day.date);
                    
                    dayCard.innerHTML = `
                        <div class="day-header">
                            <span class="day-date">${dateText} - ${getDayTypeName(day.type)}</span>
                            <button onclick="deleteDay(${day.id})" class="btn-danger">Eliminar</button>
                        </div>
                        <div>Entrada: ${day.start} - Salida: ${day.end}</div>
                        <div>Horas trabajadas: ${calculateTotalHours(day.date, day.start, day.endDate, day.end)}</div>
                    `;
                    daysList.appendChild(dayCard);
                });
            }
            
            window.deleteDay = function(id) {
                workDays = workDays.filter(day => day.id !== id);
                renderDaysList();
            };
            
            // Verificar si aplica subsidio de transporte cuando cambia el salario
            basicSalaryInput.addEventListener('input', function() {
                const basicSalary = parseFloat(this.value) || 0;
                const TWO_SMLV = 2600000; // 2 SMLV para 2025
                
                if (basicSalary >= TWO_SMLV) {
                    document.getElementById('subsidy-results').style.display = 'none';
                } else {
                    document.getElementById('subsidy-results').style.display = 'block';
                }
            });
            
            workDateInput.addEventListener('change', function() {
                if (!endDateInput.value || endDateInput.value < this.value) {
                    endDateInput.value = this.value;
                }
                endDateInput.min = this.value;
            });
            
            addDayBtn.addEventListener('click', function() {
                const workDate = document.getElementById('work-date').value;
                const endDate = document.getElementById('end-date').value || workDate;
                const startTime = document.getElementById('start-time').value;
                const endTime = document.getElementById('end-time').value;
                
                if (!workDate) {
                    alert('Por favor ingrese una fecha de entrada v√°lida');
                    return;
                }
                
                if (workDate > endDate) {
                    alert('La fecha de salida no puede ser anterior a la fecha de entrada');
                    return;
                }
                
                if (workDate === endDate && startTime >= endTime) {
                    alert('Para la misma fecha, la hora de salida debe ser posterior a la hora de entrada');
                    return;
                }
                
                const dateObj = new Date(workDate);
                let dayType = 'normal';
                
                if (isSunday(workDate)) {
                    dayType = 'sunday';
                } else if (isHoliday(dateObj)) {
                    dayType = 'festive';
                }
                
                workDays.push({
                    id: nextId++,
                    date: workDate,
                    endDate: endDate,
                    type: dayType,
                    start: startTime,
                    end: endTime
                });
                
                renderDaysList();
            });
            
            // Funci√≥n de reinicio corregida
            resetBtn.addEventListener('click', function() {
                // Limpiar campos de entrada
                vigilanteNameInput.value = '';
                basicSalaryInput.value = '';
                document.getElementById('bonus').value = '';
                workDateInput.value = '';
                endDateInput.value = '';
                document.getElementById('start-time').value = '06:00';
                document.getElementById('end-time').value = '18:00';
                includeRestDays.checked = true;
                document.getElementById('include-benefits-deductions').checked = true;
                
                // Reiniciar variables
                workDays = [];
                nextId = 1;
                
                // Limpiar resultados
                document.getElementById('hours-body').innerHTML = '';
                document.getElementById('rest-days-body').innerHTML = '';
                document.getElementById('subsidy-body').innerHTML = '';
                document.getElementById('benefits-body').innerHTML = '';
                document.getElementById('payment-body').innerHTML = '';
                document.getElementById('deductions-body').innerHTML = '';
                document.getElementById('total-earned').textContent = '$0';
                document.getElementById('total-deductions').textContent = '$0';
                document.getElementById('net-payment').textContent = '$0';
                
                // Ocultar secciones
                resultsSection.style.display = 'none';
                printBtn.style.display = 'none';
                
                // Restablecer lista de d√≠as
                renderDaysList();
            });
            
            calculateBtn.addEventListener('click', function() {
                if (!vigilanteNameInput.value.trim()) {
                    alert('Por favor ingrese el nombre del vigilante');
                    return;
                }
                
                if (workDays.length === 0) {
                    alert('Por favor agregue al menos una jornada laboral');
                    return;
                }
                
                const basicSalary = parseFloat(document.getElementById('basic-salary').value) || 0;
                const rodamientoPerDay = parseFloat(document.getElementById('bonus').value) || 0;
                const TWO_SMLV = 2600000;
                let transportSubsidy = basicSalary < TWO_SMLV ? 200000 : 0;
                const totalRodamiento = rodamientoPerDay * workDays.length;
                
                if (basicSalary <= 0) {
                    alert('Por favor ingrese un salario b√°sico v√°lido');
                    return;
                }
                
                const includeRest = includeRestDays.checked;
                const includeBenefitsDeductions = document.getElementById('include-benefits-deductions').checked;
                const includeBenefitsChecked = includeBenefitsDeductions;
                const includeDeductionsChecked = includeBenefitsDeductions;
                
                const hourlyRate = basicSalary / 240;
                const dailyRate = basicSalary / 30;
                const restDayValue = dailyRate;
                
                // Calcular subsidio de transporte proporcional (se incluye en base de prestaciones)
                const daysInMonth = 30; // Asumimos 30 d√≠as para c√°lculo proporcional
                const transportPerDay = transportSubsidy / daysInMonth;
                const transportWorkedDays = workDays.length;
                const transportRestDays = includeRest ? workDays.length : 0;
                const totalTransportSubsidy = transportPerDay * (transportWorkedDays + transportRestDays);
                
                const rates = {
                    normal: hourlyRate,
                    night: hourlyRate * 1.35,
                    extraDay: hourlyRate * 1.25,
                    extraNight: hourlyRate * 1.75,
                    festive: hourlyRate * 1.75,
                    extraFestive: hourlyRate * 2.0,
                    sunday: hourlyRate * 2.0,
                    extraSunday: hourlyRate * 2.5
                };
                
                const hoursCount = {
                    normal: 0,
                    night: 0,
                    extraDay: 0,
                    extraNight: 0,
                    festive: 0,
                    extraFestive: 0,
                    sunday: 0,
                    extraSunday: 0
                };
                
                workDays.forEach(day => {
                    const hours = calculateWorkHours(day.date, day.start, day.endDate, day.end, day.type);
                    Object.keys(hoursCount).forEach(key => {
                        hoursCount[key] += hours[key];
                    });
                });
                
                const totals = {};
                Object.keys(hoursCount).forEach(key => {
                    totals[key] = hoursCount[key] * rates[key] || 0;
                });
                
                const restDaysCount = workDays.length;
                const restDaysTotal = includeRest ? restDaysCount * restDayValue : 0;
                
                // C√ÅLCULO DE PRESTACIONES (INCLUYENDO EL SUBSIDIO DE TRANSPORTE)
                const basePrestaciones = Object.values(totals).reduce((a, b) => a + b, 0) + restDaysTotal;
                let prima = 0, cesantias = 0, interesesCesantias = 0, vacaciones = 0;
                if (includeBenefitsChecked) {
                    prima = (basePrestaciones + totalTransportSubsidy) * 0.0833;
                    cesantias = (basePrestaciones + totalTransportSubsidy) * 0.0833;
                    interesesCesantias = cesantias * 0.12;
                    vacaciones = (basePrestaciones + totalTransportSubsidy) * 0.0417;
                }
                const totalBenefits = prima + cesantias + interesesCesantias + vacaciones;
                
                // C√ÅLCULO DE DEDUCCIONES (EXCLUYENDO EL RODAMIENTO Y SUBSIDIO DE TRANSPORTE)
                const subtotalDevengado = basePrestaciones + (includeBenefitsChecked ? totalTransportSubsidy : 0) + totalBenefits;
                let healthDeduction = 0, pensionDeduction = 0;
                if (includeDeductionsChecked) {
                    healthDeduction = (basePrestaciones + totalBenefits) * 0.04;
                    pensionDeduction = (basePrestaciones + totalBenefits) * 0.04;
                }
                const totalDeductions = healthDeduction + pensionDeduction;
                
                // NETO A PAGAR (INCLUYENDO RODAMIENTO Y SUBSIDIO DE TRANSPORTE AL FINAL)
                const netPayment = (subtotalDevengado - totalDeductions) + totalRodamiento;
                
                // Actualizar resultados
                const hoursBody = document.getElementById('hours-body');
                hoursBody.innerHTML = '';
                
                const hourTypes = [
                    { key: 'normal', label: 'Horas diurnas normales' },
                    { key: 'night', label: 'Horas nocturnas normales (+35%)' },
                    { key: 'extraDay', label: 'Horas extras diurnas (+25%)' },
                    { key: 'extraNight', label: 'Horas extras nocturnas (+75%)' },
                    { key: 'festive', label: 'Horas festivas (+75%)' },
                    { key: 'extraFestive', label: 'Horas extras festivas (+100%)' },
                    { key: 'sunday', label: 'Horas dominicales (+100%)' },
                    { key: 'extraSunday', label: 'Horas extras dominicales (+150%)' }
                ];
                
                hourTypes.forEach(type => {
                    if (hoursCount[type.key] > 0) {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${type.label}</td>
                            <td>${hoursCount[type.key].toFixed(2)}</td>
                            <td>${formatCurrency(rates[type.key])}</td>
                            <td>${formatCurrency(totals[type.key])}</td>
                        `;
                        hoursBody.appendChild(row);
                    }
                });
                
                const totalHoursValue = Object.values(totals).reduce((a, b) => a + b, 0);
                const totalHoursRow = document.createElement('tr');
                totalHoursRow.className = 'total-row';
                totalHoursRow.innerHTML = `
                    <td>TOTAL HORAS TRABAJADAS</td>
                    <td>${Object.values(hoursCount).reduce((a, b) => a + b, 0).toFixed(2)}</td>
                    <td></td>
                    <td>${formatCurrency(totalHoursValue)}</td>
                `;
                hoursBody.appendChild(totalHoursRow);
                
                const restDaysBody = document.getElementById('rest-days-body');
                restDaysBody.innerHTML = '';
                if (includeRest) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>D√≠as de descanso (1 d√≠a completo c/u)</td>
                        <td>${restDaysCount}</td>
                        <td>${formatCurrency(restDayValue)}</td>
                        <td>${formatCurrency(restDaysTotal)}</td>
                    `;
                    restDaysBody.appendChild(row);
                }
                
                const subsidyBody = document.getElementById('subsidy-body');
                subsidyBody.innerHTML = '';
                if (includeBenefitsChecked && transportSubsidy > 0 && totalTransportSubsidy > 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>Subsidio de Transporte</td>
                        <td>(${transportWorkedDays + transportRestDays} d√≠as √ó ${formatCurrency(transportPerDay)})</td>
                        <td>${formatCurrency(totalTransportSubsidy)}</td>
                    `;
                    subsidyBody.appendChild(row);
                    document.getElementById('subsidy-results').style.display = 'block';
                } else {
                    document.getElementById('subsidy-results').style.display = 'none';
                }

                const benefitsBody = document.getElementById('benefits-body');
                benefitsBody.innerHTML = '';
                if (includeBenefitsChecked) {
                    const baseRow = document.createElement('tr');
                    baseRow.innerHTML = `
                        <td colspan="3"><strong>Base c√°lculo: ${formatCurrency(basePrestaciones + totalTransportSubsidy)}</strong></td>
                    `;
                    benefitsBody.appendChild(baseRow);
                    
                    const primaRow = document.createElement('tr');
                    primaRow.innerHTML = `
                        <td>Prima de servicios</td>
                        <td>8.33% de ${formatCurrency(basePrestaciones + totalTransportSubsidy)}</td>
                        <td>${formatCurrency(prima)}</td>
                    `;
                    benefitsBody.appendChild(primaRow);
                    
                    const cesantiasRow = document.createElement('tr');
                    cesantiasRow.innerHTML = `
                        <td>Cesant√≠as</td>
                        <td>8.33% de ${formatCurrency(basePrestaciones + totalTransportSubsidy)}</td>
                        <td>${formatCurrency(cesantias)}</td>
                    `;
                    benefitsBody.appendChild(cesantiasRow);
                    
                    const interesesRow = document.createElement('tr');
                    interesesRow.innerHTML = `
                        <td>Intereses sobre cesant√≠as</td>
                        <td>12% de ${formatCurrency(cesantias)}</td>
                        <td>${formatCurrency(interesesCesantias)}</td>
                    `;
                    benefitsBody.appendChild(interesesRow);
                    
                    const vacacionesRow = document.createElement('tr');
                    vacacionesRow.innerHTML = `
                        <td>Vacaciones</td>
                        <td>4.17% de ${formatCurrency(basePrestaciones + totalTransportSubsidy)}</td>
                        <td>${formatCurrency(vacaciones)}</td>
                    `;
                    benefitsBody.appendChild(vacacionesRow);
                    
                    const totalRow = document.createElement('tr');
                    totalRow.className = 'total-row';
                    totalRow.innerHTML = `
                        <td>TOTAL PRESTACIONES SOCIALES</td>
                        <td></td>
                        <td>${formatCurrency(totalBenefits)}</td>
                    `;
                    benefitsBody.appendChild(totalRow);
                }
                
                const paymentBody = document.getElementById('payment-body');
                paymentBody.innerHTML = '';
                
                const basicSalaryRow = document.createElement('tr');
                basicSalaryRow.innerHTML = `
                    <td>Salario b√°sico</td>
                    <td>${formatCurrency(basicSalary)}</td>
                `;
                paymentBody.appendChild(basicSalaryRow);
                
                if (includeBenefitsChecked && totalTransportSubsidy > 0) {
                    const transportRow = document.createElement('tr');
                    transportRow.innerHTML = `
                        <td>Subsidio de Transporte</td>
                        <td>${formatCurrency(totalTransportSubsidy)}</td>
                    `;
                    paymentBody.appendChild(transportRow);
                }
                
                if (totalRodamiento > 0) {
                    const bonusRow = document.createElement('tr');
                    bonusRow.innerHTML = `
                        <td>Valor de Rodamiento (${workDays.length} jornadas √ó ${formatCurrency(rodamientoPerDay)})</td>
                        <td>${formatCurrency(totalRodamiento)}</td>
                    `;
                    paymentBody.appendChild(bonusRow);
                }
                
                hourTypes.forEach(type => {
                    if (totals[type.key] > 0) {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${type.label}</td>
                            <td>${formatCurrency(totals[type.key])}</td>
                        `;
                        paymentBody.appendChild(row);
                    }
                });
                
                if (includeRest && restDaysTotal > 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>D√≠as de descanso liquidados</td>
                        <td>${formatCurrency(restDaysTotal)}</td>
                    `;
                    paymentBody.appendChild(row);
                }
                
                if (includeBenefitsChecked && totalBenefits > 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>Prestaciones sociales</td>
                        <td>${formatCurrency(totalBenefits)}</td>
                    `;
                    paymentBody.appendChild(row);
                }
                
                const totalEarnedRow = document.createElement('tr');
                totalEarnedRow.className = 'total-row';
                totalEarnedRow.innerHTML = `
                    <td>TOTAL DEVENGADO</td>
                    <td>${formatCurrency(subtotalDevengado + totalRodamiento)}</td>
                `;
                paymentBody.appendChild(totalEarnedRow);
                
                const deductionsBody = document.getElementById('deductions-body');
                deductionsBody.innerHTML = '';
                if (includeDeductionsChecked) {
                    const saludRow = document.createElement('tr');
                    saludRow.innerHTML = `
                        <td>Salud</td>
                        <td>4%</td>
                        <td>${formatCurrency(healthDeduction)}</td>
                    `;
                    deductionsBody.appendChild(saludRow);
                    
                    const pensionRow = document.createElement('tr');
                    pensionRow.innerHTML = `
                        <td>Pensi√≥n</td>
                        <td>4%</td>
                        <td>${formatCurrency(pensionDeduction)}</td>
                    `;
                    deductionsBody.appendChild(pensionRow);
                    
                    const totalDeductionsRow = document.createElement('tr');
                    totalDeductionsRow.className = 'total-row';
                    totalDeductionsRow.innerHTML = `
                        <td>TOTAL DEDUCCIONES</td>
                        <td>8%</td>
                        <td>${formatCurrency(totalDeductions)}</td>
                    `;
                    deductionsBody.appendChild(totalDeductionsRow);
                }
                
                document.getElementById('total-earned').textContent = formatCurrency(subtotalDevengado + totalRodamiento);
                document.getElementById('total-deductions').textContent = formatCurrency(totalDeductions);
                document.getElementById('net-payment').textContent = formatCurrency(netPayment);
                
                resultsSection.style.display = 'block';
                printBtn.style.display = 'block';
            });

            printBtn.addEventListener('click', () => {
                window.print();
            });

            // Animaci√≥n del tutorial
            const style = document.createElement('style');
            style.textContent = `
                @keyframes scrollTutorial {
                    0% { transform: translateX(0); }
                    100% { transform: translateX(-100%); }
                }
            `;
            document.head.appendChild(style);

            // --- Test Suite for calculateWorkHours ---
            let currentTestInputForLogging;
            function simpleAssertEqual(actual, expected, testName) {
                const defaultKeys = { normal: 0, night: 0, extraDay: 0, extraNight: 0, festive: 0, extraFestive: 0, sunday: 0, extraSunday: 0 };
                const actualFull = { ...defaultKeys, ...actual };
                const expectedFull = { ...defaultKeys, ...expected };
                const actualStr = JSON.stringify(actualFull);
                const expectedStr = JSON.stringify(expectedFull);

                if (actualStr === expectedStr) {
                    console.log(`PASS: ${testName}`);
                } else {
                    console.error(`FAIL: ${testName}`);
                    console.log("   Input:", currentTestInputForLogging);
                    console.log("   Actual:", actualFull);
                    console.log("   Expected:", expectedFull);
                }
            }

            function runWorkHoursTests() {
                console.log("--- Running calculateWorkHours Tests ---");
                let args, result;

                // Scenario 1: Normal Day, <8 hours, daytime
                currentTestInputForLogging = ['2025-01-02', '08:00', '2025-01-02', '12:00', 'normal']; // Thu
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { normal: 4 }, "Test 1: Normal Day, <8h, daytime");

                // Scenario 2: Normal Day, >8 hours, crossing midnight, includes night
                currentTestInputForLogging = ['2025-01-02', '14:00', '2025-01-03', '02:00', 'normal']; // Thu to Fri
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { normal: 7, night: 3, extraNight: 2 }, "Test 2: Normal Day, >8h, cross midnight, night hours");

                // Scenario 3: Normal Day to Holiday
                currentTestInputForLogging = ['2025-04-16', '20:00', '2025-04-17', '04:00', 'normal']; // Wed normal to Thu Santo (Festive)
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { normal: 1, night: 3, festive: 4 }, "Test 3: Normal Day to Holiday");

                // Scenario 4: Normal Day to Sunday
                currentTestInputForLogging = ['2025-01-04', '20:00', '2025-01-05', '04:00', 'normal']; // Sat normal to Sun
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { normal: 1, night: 3, sunday: 4 }, "Test 4: Normal Day to Sunday");

                // Scenario 5: Sunday to Normal Day, >8 hours total shift
                // 2025-01-12 is Sunday. 2025-01-13 is Monday (Normal).
                currentTestInputForLogging = ['2025-01-12', '20:00', '2025-01-13', '06:00', 'sunday'];
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { sunday: 4, night: 6 }, "Test 5: Sunday to Normal Day");

                // Scenario 6: Holiday, >8 hours
                currentTestInputForLogging = ['2025-01-01', '14:00', '2025-01-01', '23:00', 'festive']; // Festive, 9 hours
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { festive: 8, extraFestive: 1 }, "Test 6: Holiday, >8h");

                // Scenario 7: Sunday, >8 hours
                currentTestInputForLogging = ['2025-01-05', '14:00', '2025-01-05', '23:00', 'sunday']; // Sunday, 9 hours
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { sunday: 8, extraSunday: 1 }, "Test 7: Sunday, >8h");

                // Scenario 8: All night shift on a normal day, <8 hours
                currentTestInputForLogging = ['2025-01-02', '22:00', '2025-01-03', '05:00', 'normal']; // Thu night to Fri morning
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { night: 7 }, "Test 8: All night, normal day, <8h");

                // Scenario 9: Shift starting normal, ending holiday, holiday part > 8h
                currentTestInputForLogging = ['2025-04-16', '22:00', '2025-04-17', '10:00', 'normal']; // Wed normal to Thu Santo (Festive)
                result = calculateWorkHours(...currentTestInputForLogging);
                simpleAssertEqual(result, { night: 2, festive: 8, extraFestive: 2 }, "Test 9: Normal to Holiday, holiday part >8h");

                console.log("--- Finished calculateWorkHours Tests ---");
            }

            runWorkHoursTests(); // Automatically run tests when DOM is loaded and script runs.

        });
    </script>
</body>
</html>
